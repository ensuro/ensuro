// SPDX-License-Identifier: Apache-2.0
pragma solidity ^0.8.0;

import {IERC20Metadata} from "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";
import {Policy} from "../Policy.sol";
import {IEToken} from "./IEToken.sol";
import {IPolicyPoolConfig} from "./IPolicyPoolConfig.sol";

interface IPolicyPool {
  function currency() external view returns (IERC20Metadata);

  function config() external view returns (IPolicyPoolConfig);

  function policyNFT() external view returns (address);

  /**
   * @dev Creates a new Policy. Must be called from an active RiskModule
   * @param policy A policy created with {Policy-initialize}
   * @param customer The address of the policy holder and the payer of the premiums
   * @param internalId A unique id within the RiskModule, that will be used to compute the policy id
   * @return The policy id, identifying the NFT and the policy
   */
  function newPolicy(
    Policy.PolicyData memory policy,
    address customer,
    uint96 internalId
  ) external returns (uint256);

  function resolvePolicy(Policy.PolicyData calldata policy, uint256 payout) external;

  function resolvePolicyFullPayout(Policy.PolicyData calldata policy, bool customerWon) external;

  function getETokenCount() external view returns (uint256);

  function getETokenAt(uint256 index) external view returns (IEToken);

  function deposit(IEToken eToken, uint256 amount) external;

  function withdraw(IEToken eToken, uint256 amount) external returns (uint256);

  function totalETokenSupply() external view returns (uint256);
}
